<!DOCTYPE html>
<html>
<head>
    <title>Separator Sizing Results</title>
    <meta charset="UTF-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script type="text/javascript" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>

    <style>
        body {
            background-color: #f8f9fa;
        }
        .container {
            max-width: 960px;
        }
        .section-title {
            margin-top: 40px;
            font-weight: 600;
        }
        svg {
            margin-top: 30px;
            width: 100%;
            max-width: 100%;
            height: auto;
            border: 1px solid #ced4da;
            background-color: #ffffff;
        }
        .label-text {
            font-size: 12px;
            background-color: white;
            padding: 2px 4px;
        }
    </style>
</head>
<body>
<div class="container mt-5">
    <h2 class="mb-4">‚úÖ {{ type|title }} Separator Sizing Results</h2>

    <table class="table table-bordered">
        <tbody>
            <tr><th>Design Name</th><td>{{ design.name }}</td></tr>
            <tr><th>Gas Flow Rate (Wg)</th><td>{{ design.Wg }} lb/hr</td></tr>
            <tr><th>Liquid Flow Rate (Wl)</th><td>{{ design.Wl }} lb/hr</td></tr>
            <tr><th>Gas Density (Pg)</th><td>{{ design.Pg }} lb/ft¬≥</td></tr>
            <tr><th>Liquid Density (Pl)</th><td>{{ design.Pl }} lb/ft¬≥</td></tr>
            <tr><th>Gas Viscosity (Ug)</th><td>{{ design.Ug }} cP</td></tr>
            <tr><th>Droplet Diameter (dp)</th><td>{{ design.dp }} ft</td></tr>
            <tr><th>Velocity Factor</th><td>{{ design.velocity_factor }}</td></tr>
            <tr><th>Holdup Time</th><td>{{ design.holdup_time }} min</td></tr>
            <tr><th>Surge Factor</th><td>{{ design.surge_factor }}</td></tr>
            <tr><th>Operating Pressure</th><td>{{ design.pressure }} psia</td></tr>
            <tr><th>Mist Eliminator Allowance</th><td>{{ design.mist_eliminator_ring }} ft</td></tr>
            {% if type == 'horizontal' %}
            
            <tr><th>Length-to-Diameter Ratio (L/D)</th><td>{{ design.L_D_ratio }}</td></tr>
            <!-- Liquid Height Equation -->
<h4 class="section-title">üìê Horizontal Separator Liquid Height</h4>

<div class="bg-light p-3 border rounded">
    <p>
        $$ H_L = {{ design.H_liquid|floatformat:2 }} \, \text{ft} $$
    </p>
</div>

            {% endif %}
        </tbody>
    </table>

    <h4 class="section-title">üìä Computed Results</h4>
    <table class="table table-striped">
        <tbody>
            <tr><th>Cd (Drag Coefficient)</th><td>{{ design.Cd|floatformat:4 }}</td></tr>
            <tr><th>K (Souders-Brown Constant)</th><td>{{ design.K|floatformat:4 }} ft/s</td></tr>
            <tr><th>Vt (Terminal Velocity)</th><td>{{ design.Vt|floatformat:4 }} ft/s</td></tr>
            <tr><th>Vv (Design Gas Velocity)</th><td>{{ design.Vv|floatformat:4 }} ft/s</td></tr>
            <tr><th>Qg (Gas Volumetric Flow)</th><td>{{ design.Qg|floatformat:4 }} ft¬≥/min</td></tr>
            <tr><th>Ql (Liquid Volumetric Flow)</th><td>{{ design.Ql|floatformat:4 }} ft¬≥/min</td></tr>
            <tr><th>Di (Internal Diameter)</th><td>{{ design.Di|floatformat:4 }} ft</td></tr>
            <tr><th>A (Cross-sectional Area)</th><td>{{ design.A|floatformat:4 }} ft¬≤</td></tr>
            {% if type == 'horizontal' %}
            <tr><th>Vapor Zone Height (Hv)</th><td>{{ design.Hv|floatformat:2 }} ft</td></tr>

            <tr><th>L (Vessel Length)</th><td>{{ design.L|floatformat:4 }} ft</td></tr>
            <tr><th>Holdup Height</th><td>{{ design.Holdup_Height|floatformat:4 }} ft</td></tr>
<tr><th>Surge Height</th><td>{{ design.Surge_Height|floatformat:4 }} ft</td></tr>
<tr><th>Total Liquid Height</th><td>{{ design.H_liquid|floatformat:4 }} ft</td></tr>
{% if design.Hme > 0 %}
<tr><th>Mist Eliminator Height</th><td>{{ design.Hme|floatformat:2 }} ft</td></tr>
{% endif %}

            {% endif %}
            <tr><th>Holdup Volume</th><td>{{ design.V_holdup|floatformat:4 }} ft¬≥</td></tr>
            <tr><th>Surge Volume</th><td>{{ design.V_surge|floatformat:4 }} ft¬≥</td></tr>
        {% if type == 'vertical' %}
        <tr><th>Low Liquid Level Height (LLL)</th><td>{{ design.LLL }} in</td></tr>
        {% endif %}
        </tbody>
    </table>

 {% if type == "vertical" %}
<!-- Load MathJax -->
<script type="text/javascript" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>

<h4 class="section-title">üìê Vertical Separator Height Breakdown</h4>

<!-- Display Equation -->
<div class="bg-white p-3 border rounded mb-3">
    $$ H_T = H_{LLL} + H_H + H_S + H_{LIN} + H_D + H_{ME} \quad \text{(in ft)} $$
</div>
<div class="height-components">
  <h3>Vertical Separator Height Components Explanation</h3>
  <ul>
    <li><strong>H<sub>LLL</sub></strong>: Low Liquid Level height ‚Äì the minimum liquid level maintained to avoid gas blow-through.</li>
    <li><strong>H<sub>H</sub></strong>: Holdup Height ‚Äì height required to contain the normal operating liquid volume.</li>
    <li><strong>H<sub>S</sub></strong>: Surge Height ‚Äì extra liquid height capacity to handle sudden inflow surges.</li>
    <li><strong>H<sub>LIN</sub></strong>: Height from liquid interface to nozzle centerline ‚Äì used to position the inlet nozzle above liquid level for separation efficiency.</li>
    <li><strong>H<sub>D</sub></strong>: Disengagement Height ‚Äì space for gas and liquid to separate without re-entrainment.</li>
    <li><strong>H<sub>ME</sub></strong>: Mist Eliminator Height ‚Äì vertical clearance for installing and operating a mist eliminator (e.g., wire mesh).</li>
  </ul>
  <p><em>All heights are in feet (ft).</em></p>
</div>

<!-- Substituted Values -->
<div class="bg-light p-3 border rounded">
    <p>
        $$ H_T = {{ design.LLL|floatformat:2 }}
        + {{ design.Holdup_Height|floatformat:2 }}
        + {{ design.Surge_Height|floatformat:2 }}
        + {{ design.H_lin|floatformat:2 }}
        + {{ design.Hd|floatformat:2 }}
        + {{ design.Hme|floatformat:2 }} $$
    </p>
    <p>
        $$ H_T = {{ design.H_total|floatformat:2 }} \, \text{ft} $$
    </p>
</div>
    <svg viewBox="0 0 400 750" preserveAspectRatio="xMidYMid meet">
        <defs>
            <marker id="arrow" markerWidth="10" markerHeight="10" refX="0" refY="3" orient="auto">
                <path d="M0,0 L0,6 L9,3 z" fill="black" />
            </marker>
        </defs>

        <rect x="100" y="100" width="80" height="500" rx="40" fill="#cce5ff" stroke="#000" stroke-width="2"/>

        <!-- Horizontal dashed level lines -->
        <line x1="100" y1="580" x2="180" y2="580" stroke="black" stroke-dasharray="4"/>
        <line x1="100" y1="540" x2="180" y2="540" stroke="black" stroke-dasharray="4"/>
        <line x1="100" y1="500" x2="180" y2="500" stroke="black" stroke-dasharray="4"/>
        <line x1="100" y1="420" x2="180" y2="420" stroke="black" stroke-dasharray="4"/>
        <line x1="100" y1="250" x2="180" y2="250" stroke="black" stroke-dasharray="4"/>
        <line x1="100" y1="100" x2="180" y2="100" stroke="black" stroke-dasharray="4"/>

        <!-- Height Annotations Right -->
        <line x1="220" y1="580" x2="220" y2="600" stroke="black" stroke-width="2" marker-start="url(#arrow)" marker-end="url(#arrow)"/>
    

        <line x1="220" y1="540" x2="220" y2="580" stroke="black" stroke-width="2" marker-start="url(#arrow)" marker-end="url(#arrow)"/>
        <text x="230" y="562" class="label-text">H<sub>H</sub> = {{ design.Holdup_Height|floatformat:2 }} ft</text>

        <line x1="220" y1="500" x2="220" y2="540" stroke="black" stroke-width="2" marker-start="url(#arrow)" marker-end="url(#arrow)"/>
        <text x="230" y="522" class="label-text">H<sub>S</sub> = {{ design.Surge_Height|floatformat:2 }} ft</text>

        <line x1="220" y1="420" x2="220" y2="500" stroke="black" stroke-width="2" marker-start="url(#arrow)" marker-end="url(#arrow)"/>
        <text x="230" y="462" class="label-text">H<sub>LIN</sub> = {{ design.H_lin|floatformat:2 }} ft</text>

        <line x1="220" y1="250" x2="220" y2="420" stroke="black" stroke-width="2" marker-start="url(#arrow)" marker-end="url(#arrow)"/>
        <text x="230" y="345" class="label-text">H<sub>D</sub> = {{ design.Hd|floatformat:2 }} ft</text>

        {% if design.Hme > 0 %}
        <line x1="220" y1="100" x2="220" y2="250" stroke="black" stroke-width="2" marker-start="url(#arrow)" marker-end="url(#arrow)"/>
        <text x="230" y="180" class="label-text">H<sub>ME</sub> = {{ design.Hme|floatformat:2 }} ft</text>
        {% endif %}
    </svg>

   {% elif type == "horizontal" %}
    <h4 class="section-title">üìê Horizontal Separator Diagram</h4>
    <svg viewBox="0 0 700 260" preserveAspectRatio="xMidYMid meet">
        <defs>
            <marker id="arrow" markerWidth="10" markerHeight="10" refX="0" refY="3" orient="auto">
                <path d="M0,0 L0,6 L9,3 z" fill="black" />
            </marker>
        </defs>

        <!-- Vessel -->
        <rect x="100" y="80" width="500" height="100" rx="50" fill="#cce5ff" stroke="#000" stroke-width="2"/>

        <!-- Inlet -->
        <line x1="40" y1="130" x2="100" y2="130" stroke="#000" stroke-width="4"/>
        <text x="10" y="125" class="label-text">Inlet</text>

        <!-- Gas Outlet -->
        <line x1="350" y1="80" x2="350" y2="40" stroke="#000" stroke-width="3"/>
        <text x="360" y="45" class="label-text">Gas Out</text>

        <!-- Liquid Outlet -->
        <line x1="600" y1="130" x2="660" y2="130" stroke="#000" stroke-width="4"/>
        <text x="610" y="120" class="label-text">Liquid Out</text>

        <!-- Di -->
        <line x1="610" y1="80" x2="610" y2="180" stroke="red" stroke-width="2" marker-start="url(#arrow)" marker-end="url(#arrow)"/>
        <text x="620" y="130" class="label-text">Di = {{ design.Di|floatformat:2 }} ft</text>

        <!-- L -->
        <line x1="100" y1="200" x2="600" y2="200" stroke="red" stroke-width="2" marker-start="url(#arrow)" marker-end="url(#arrow)"/>
        <text x="300" y="215" class="label-text">L = {{ design.L|floatformat:2 }} ft</text>

        <!-- LLL -->
        <line x1="100" y1="145" x2="600" y2="145" stroke="blue" stroke-dasharray="5,3"/>
      

        <!-- Holdup Volume -->
        <rect x="100" y="140" width="500" height="20" fill="blue" opacity="0.2"/>
        <text x="610" y="155" class="label-text">Holdup</text>

        <!-- Surge Volume -->
        <rect x="100" y="160" width="500" height="20" fill="blue" opacity="0.1"/>
        <text x="610" y="175" class="label-text">Surge</text>
    </svg>
    {% endif %}

    <a href="/" class="btn btn-secondary mt-4">‚Üê Back to Design</a>
</div>
</body>
</html>
